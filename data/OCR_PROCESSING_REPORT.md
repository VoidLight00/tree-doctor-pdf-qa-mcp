# 나무의사 제5-6회 기출문제 PDF OCR 처리 보고서

## 📋 작업 요약

### 처리 대상
- **제5회**: [Codekiller]제5회 기출문제 해설집(v1.0).pdf
- **제6회**: [Codekiller]제6회 기출문제 해설집(v1.0).pdf

### 처리 시도 방법

1. **고품질 OCR (advanced_exam_ocr.py)**
   - 300 DPI 고해상도 변환
   - 한국어 특화 Tesseract OCR
   - 이미지 전처리 (노이즈 제거, 대비 향상, 이진화)
   - 결과: 시간 초과 (80페이지 처리에 2분 이상 소요)

2. **PyMuPDF 텍스트 추출 (pdf_to_markdown_pymupdf.py)**
   - PDF 내장 텍스트 추출
   - 패턴 매칭으로 문제 구조 파악
   - 결과: 제5회 67문제, 제6회 56문제 추출
   - 문제점: 많은 문제가 빈 내용으로 추출됨

3. **pdfplumber 추출 (pdf_extract_pdfplumber.py)**
   - 페이지별 텍스트 추출
   - 선택지, 정답, 해설 패턴 인식
   - 결과: 제5회 20문제, 제6회 18문제 추출
   - 문제점: 대부분의 페이지에서 텍스트 추출 실패

4. **향상된 OCR (enhanced_pdf_ocr.py)**
   - OpenCV를 활용한 고급 이미지 전처리
   - 영역별 OCR 수행
   - 결과: 시간 초과 (페이지당 약 5초 소요)

## 🔍 분석 결과

### PDF 특성
- 이미지 기반 PDF (스캔 문서)
- 폰트 정보 누락 (FontBBox 경고 다수 발생)
- 복잡한 레이아웃 (표, 다단 구성)
- 총 페이지: 제5회 80페이지, 제6회 77페이지

### 추출 성공률
- PyMuPDF: 약 45% (67/150 문제)
- pdfplumber: 약 13% (20/150 문제)
- OCR 방식: 높은 정확도 예상되나 처리 시간 과다

## 📊 최종 결과

### 생성된 파일
1. `/Users/voidlight/tree-doctor-pdf-qa-mcp/data/exam-5th-complete.md`
   - 추출 문제 수: 20개
   - 키워드 추출 완료
   - 부분적인 문제 내용 포함

2. `/Users/voidlight/tree-doctor-pdf-qa-mcp/data/exam-6th-complete.md`
   - 추출 문제 수: 18개
   - 키워드 추출 완료
   - 부분적인 문제 내용 포함

### 추출된 주요 정보
- 녹병균 관련 정보 (병명, 기주, 전파 경로)
- 수목해충 조사법 (트랩 종류, 사용법)
- 시토키닌 관련 생리학 정보
- 농약 안전사용 기준
- 토양학 관련 암석 분류

## 💡 권장사항

### 단기 해결책
1. **수동 입력**: 중요한 문제들을 수동으로 입력
2. **부분 OCR**: 특정 페이지만 선택하여 OCR 처리
3. **클라우드 OCR**: Google Vision API 또는 AWS Textract 활용

### 장기 해결책
1. **PDF 재생성**: 원본 문서에서 텍스트 기반 PDF로 재생성
2. **OCR 최적화**: 병렬 처리 및 GPU 가속 활용
3. **전문 도구 활용**: ABBYY FineReader 등 상용 OCR 도구

## 🛠️ 기술적 제한사항

1. **Tesseract OCR 한계**
   - 한국어 인식률이 영어보다 낮음
   - 복잡한 레이아웃 처리 어려움
   - 처리 속도가 느림

2. **PDF 구조 문제**
   - 이미지로만 구성된 페이지 다수
   - 텍스트 레이어 부재
   - 폰트 정보 손실

3. **시스템 리소스**
   - 고해상도 이미지 처리 시 메모리 사용량 증가
   - CPU 기반 처리로 속도 제한

## 📝 결론

현재 상태에서는 완벽한 자동 추출이 어렵습니다. 추출된 부분적인 데이터는 학습 자료로 활용 가능하나, 완전한 기출문제 복원을 위해서는 추가적인 처리가 필요합니다.

**처리 완료 시간**: 2025-07-28 15:52:00