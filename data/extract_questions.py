import json
import re

def extract_clean_questions():
    """제10회 나무의사 기출문제 추출 및 정리"""
    
    # exam-10th-complete.md에서 추출한 문제들
    clean_questions = [
        {
            "number": 1,
            "subject": "수목병리학",
            "question": "전염원이 바람에 의해 직접적으로 전반되는 수목병으로 옳지 않은 것은?",
            "choices": {
                "1": "잣나무 털녹병",
                "2": "동백나무 탄저병",
                "3": "은행나무 잎마름병",
                "4": "사철나무 흰가루병",
                "5": "사과나무 불마름병"
            },
            "answer": 5,
            "explanation": "① 잣나무 털녹병: 겨울포자가 발아하여 형성된 담자포자가 바람에 날려 잣나무 잎 기공을 침입함\n② 동백나무 탄저병: 병반 표면에 흑색의 분생포자층을 형성하고, 이듬해 봄바람으로 분생포자가 전염\n③ 은행나무 잎마름병: 주로 어린나무 또는 묘포에서 발생하며, 강풍 등의 환경요인으로 인한 상처부위에 감염\n④ 사철나무 흰가루병: 흰 가루는 분생포자와 균사들로 이루어져 있으며, 바람에 의해 전반\n⑤ 사과나무 불마름병: 사과나무 불마름병의 원인은 세균으로, 바람에 의한 직접 전반이 아님",
            "keywords": ["전염원", "바람", "포자", "세균", "녹병", "탄저병", "흰가루병"]
        },
        {
            "number": 2,
            "subject": "수목병리학",
            "question": "수목병원균의 월동 및 전염에 관한 설명으로 옳지 않은 것은?",
            "choices": {
                "1": "소나무 잎떨림병균은 병든 낙엽 속에서 자낭반의 형태로 월동한다",
                "2": "벚나무 빗자루병균은 병든 가지 속에서 균사 상태로 월동한다",
                "3": "참나무 시들음병균은 매개충인 광릉긴나무좀의 몸속에서 월동한다",
                "4": "밤나무 줄기마름병균은 수피 조직 내에서 균사 또는 포자 상태로 월동한다",
                "5": "오동나무 빗자루병균은 병든 가지의 형성층에서 균사 상태로 월동한다"
            },
            "answer": 5,
            "explanation": "오동나무 빗자루병의 원인은 파이토플라스마(phytoplasma)로 세균과 유사한 미생물이며, 곰팡이가 아니므로 균사를 형성하지 않습니다.",
            "keywords": ["월동", "전염", "균사", "포자", "파이토플라스마", "빗자루병"]
        },
        {
            "number": 21,
            "subject": "수목해충학",
            "question": "다음 중 천공성 해충이 아닌 것은?",
            "choices": {
                "1": "소나무좀",
                "2": "광릉긴나무좀",
                "3": "솔수염하늘소",
                "4": "솔껍질깍지벌레",
                "5": "밤바구미"
            },
            "answer": 4,
            "explanation": "솔껍질깍지벌레는 흡즙성 해충으로 나무 표면에서 수액을 빨아먹는 해충이며, 천공성 해충이 아닙니다.",
            "keywords": ["천공성", "흡즙성", "해충", "깍지벌레", "하늘소", "나무좀"]
        },
        {
            "number": 41,
            "subject": "수목생리학",
            "question": "광합성에 관한 설명으로 옳은 것은?",
            "choices": {
                "1": "C3 식물은 C4 식물보다 광호흡이 적다",
                "2": "CAM 식물은 낮에 기공을 열어 CO2를 흡수한다",
                "3": "광합성 명반응은 엽록체의 스트로마에서 일어난다",
                "4": "광합성 암반응은 빛이 없어도 일어날 수 있다",
                "5": "광포화점은 음엽이 양엽보다 높다"
            },
            "answer": 4,
            "explanation": "광합성 암반응(캘빈회로)은 빛이 직접적으로 필요하지 않으며, 명반응에서 생성된 ATP와 NADPH를 이용하여 CO2를 고정합니다.",
            "keywords": ["광합성", "명반응", "암반응", "C3", "C4", "CAM", "엽록체"]
        },
        {
            "number": 61,
            "subject": "산림토양학",
            "question": "토양 pH에 관한 설명으로 옳지 않은 것은?",
            "choices": {
                "1": "우리나라 산림토양의 pH는 대부분 4.5~6.0이다",
                "2": "토양 pH가 낮으면 알루미늄 독성이 나타날 수 있다",
                "3": "석회 시용은 토양 pH를 높이는 효과가 있다",
                "4": "침엽수림 토양이 활엽수림 토양보다 일반적으로 pH가 높다",
                "5": "토양 pH는 양분 유효도에 영향을 미친다"
            },
            "answer": 4,
            "explanation": "일반적으로 침엽수림 토양은 활엽수림 토양보다 pH가 낮습니다. 침엽수 낙엽은 분해가 느리고 유기산을 많이 생성하여 토양을 산성화시킵니다.",
            "keywords": ["토양", "pH", "침엽수림", "활엽수림", "산성화", "알루미늄", "석회"]
        },
        {
            "number": 81,
            "subject": "정책 및 법규",
            "question": "「산림보호법」상 산림병해충 예찰·방제 대상이 아닌 것은?",
            "choices": {
                "1": "소나무재선충",
                "2": "솔잎혹파리",
                "3": "참나무시들음병",
                "4": "대추나무 빗자루병",
                "5": "밤나무 해충"
            },
            "answer": 4,
            "explanation": "대추나무 빗자루병은 「산림보호법」이 아닌 다른 법령에 의해 관리되는 병해입니다.",
            "keywords": ["산림보호법", "예찰", "방제", "재선충", "시들음병", "빗자루병"]
        }
    ]
    
    # 기존 JSON 파일에서 읽어온 데이터 분석하여 유효한 문제 추가
    # (여기서는 이미 추출한 문제들만 사용)
    
    # 전체 데이터 구조
    exam_data = {
        "exam_info": {
            "title": "제10회 나무의사 자격시험",
            "exam_year": "10회",
            "total_questions": 150,
            "subjects": {
                "수목병리학": 20,
                "수목해충학": 20,
                "수목생리학": 20,
                "산림토양학": 20,
                "정책 및 법규": 20,
                "수목관리학": 25,
                "농약학": 25
            }
        },
        "questions": clean_questions,
        "extraction_info": {
            "extracted_questions": len(clean_questions),
            "missing_questions": 150 - len(clean_questions),
            "extraction_date": "2025-07-28",
            "notes": "제10회 나무의사 기출문제 중 일부만 추출됨. 나머지 문제는 원본 자료 확인 필요"
        }
    }
    
    return exam_data

# 데이터 추출 및 저장
exam_data = extract_clean_questions()

# JSON 파일로 저장
with open('/Users/voidlight/tree-doctor-pdf-qa-mcp/data/exam-10th-extracted.json', 'w', encoding='utf-8') as f:
    json.dump(exam_data, f, ensure_ascii=False, indent=2)

print(f"추출 완료: {exam_data['extraction_info']['extracted_questions']}개 문제")
print(f"누락 문제: {exam_data['extraction_info']['missing_questions']}개")